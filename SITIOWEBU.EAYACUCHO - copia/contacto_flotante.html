<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>¡Escríbenos! – Contacto Interactivo</title>
    <meta name="description" content="Una experiencia interactiva para contactar al Colegio Gran Mariscal de Ayacucho de Catavi.">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #0a1929, #1a374d, #0a1929); 
            color: white;
            font-family: 'Inter', sans-serif;
            text-align: center;
        }

        header, footer {
            display: none;
        }

        canvas {
            display: block;
            position: fixed; 
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1; 
        }

        .overlay-content {
            position: relative;
            z-index: 10;
            padding: 2rem;
            max-width: 90%;
            background: rgba(18, 41, 60, 0.85); 
            backdrop-filter: blur(12px); 
            border-radius: 20px;
            box-shadow: 0 0 40px rgba(37, 99, 235, 0.3), 0 10px 30px rgba(0, 0, 0, 0.8);
            animation: fadeIn 1.5s ease-out;
            cursor: pointer;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease;
            border: 2px solid rgba(93, 138, 168, 0.4); 
        }
        .overlay-content:hover {
            transform: scale(1.05); 
            box-shadow: 0 0 60px rgba(37, 99, 235, 0.6), 0 15px 40px rgba(0, 0, 0, 0.9);
        }
        .overlay-content h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 3rem;
            margin-bottom: 0.5rem;
            color: #93c5fd; 
            text-shadow: 0 0 20px rgba(147, 197, 253, 0.8);
        }
        .overlay-content p {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            color: #e0e7ff;
        }
        .btn-action {
            display: inline-block;
            background: linear-gradient(135deg, #2563eb, #1d4ed8); 
            color: white;
            padding: 1rem 2.5rem;
            border-radius: 12px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.4);
        }
        .btn-action:hover {
            background: linear-gradient(135deg, #1d4ed8, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.6);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @media (max-width: 768px) {
            .overlay-content h1 {
                font-size: 2rem;
            }
            .overlay-content p {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    
    <div class="overlay-content" onclick="window.location.href='contacto.html'">
        <h1>¿Tienes Preguntas? ¡Contáctanos!</h1>
        <p>Haz clic en este mensaje o interactúa con el modelo 3D para continuar.</p>
        <a href="contacto.html" class="btn-action">Ir al Formulario de Contacto</a>
    </div>

    <script type="module">
        import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js';
        import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/controls/OrbitControls.js';
        import { gsap } from 'https://cdn.skypack.dev/gsap';

        let scene, camera, renderer, controls;
        let notebook, pencil, particleSystem1, particleSystem2;
        const pointer = new THREE.Vector2();
        const raycaster = new THREE.Raycaster();

        // FUNCIÓN MEJORADA PARA CREAR PARTÍCULAS
        function createEnhancedParticles(config) {
            const defaults = {
                count: 1000,
                size: 0.04,
                rangeX: 12,
                rangeY: 12,
                rangeZ: 12,
                color1: '#2563eb',
                color2: '#93c5fd',
                opacity: 0.7
            };

            const settings = { ...defaults, ...config };
            const particleGeometry = new THREE.BufferGeometry();
            const positions = [];
            const colors = [];
            const sizes = [];
            const velocities = [];

            const color1 = new THREE.Color(settings.color1);
            const color2 = new THREE.Color(settings.color2);

            for (let i = 0; i < settings.count; i++) {
                const x = (Math.random() - 0.5) * settings.rangeX;
                const y = (Math.random() - 0.5) * settings.rangeY;
                const z = (Math.random() - 0.5) * settings.rangeZ;
                positions.push(x, y, z);

                const mixFactor = Math.random();
                const color = color1.clone().lerp(color2, mixFactor);
                colors.push(color.r, color.g, color.b);

                sizes.push(settings.size * (0.5 + Math.random() * 1.5));

                velocities.push(
                    (Math.random() - 0.5) * 0.002,
                    Math.random() * 0.003 + 0.001,
                    (Math.random() - 0.5) * 0.002
                );
            }

            particleGeometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            particleGeometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));

            const particleMaterial = new THREE.PointsMaterial({
                size: settings.size,
                sizeAttenuation: true,
                transparent: true,
                opacity: settings.opacity,
                blending: THREE.AdditiveBlending,
                vertexColors: true,
                depthWrite: false
            });

            const particles = new THREE.Points(particleGeometry, particleMaterial);
            particles.userData = { velocities, settings };

            return particles;
        }

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a1929); 
            scene.fog = new THREE.FogExp2(0x0a1929, 0.02);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 3.5);

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Luces mejoradas
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);

            const directionalLight1 = new THREE.DirectionalLight(0x93c5fd, 1.2);
            directionalLight1.position.set(3, 5, 3);
            scene.add(directionalLight1);

            const directionalLight2 = new THREE.DirectionalLight(0x2563eb, 0.8);
            directionalLight2.position.set(-3, -3, -2);
            scene.add(directionalLight2);

            const pointLight = new THREE.PointLight(0x2563eb, 1, 10);
            pointLight.position.set(0, 2, 2);
            scene.add(pointLight);

            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.screenSpacePanning = false;
            controls.minDistance = 2.5;
            controls.maxDistance = 6;
            controls.autoRotate = true; 
            controls.autoRotateSpeed = 0.8;

            // CUADERNO MEJORADO
            const notebookGroup = new THREE.Group();
            const coverGeometry = new THREE.BoxGeometry(1.8, 2.5, 0.12);
            const coverMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x2563eb,
                roughness: 0.4,
                metalness: 0.6,
                emissive: 0x1e3a8a,
                emissiveIntensity: 0.2
            });
            const cover = new THREE.Mesh(coverGeometry, coverMaterial);
            notebookGroup.add(cover);
            
            const pagesGeometry = new THREE.BoxGeometry(1.7, 2.4, 0.12);
            const pagesMaterial = new THREE.MeshStandardMaterial({ 
                color: 0xf8fafc,
                roughness: 0.8,
                metalness: 0.1
            });
            const pages = new THREE.Mesh(pagesGeometry, pagesMaterial);
            pages.position.set(0, 0, 0.08); 
            notebookGroup.add(pages);

            const spiralMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x93c5fd,
                roughness: 0.2,
                metalness: 0.9,
                emissive: 0x2563eb,
                emissiveIntensity: 0.3
            });
            
            for (let i = -1.0; i <= 1.0; i += 0.22) { 
                const spiralRing = new THREE.Mesh(
                    new THREE.TorusGeometry(0.06, 0.025, 12, 20),
                    spiralMaterial
                );
                spiralRing.rotation.y = Math.PI / 2; 
                spiralRing.position.set(-0.9, i, 0.06);
                notebookGroup.add(spiralRing);
            }
            
            notebookGroup.position.set(-0.6, 0, 0); 
            scene.add(notebookGroup);
            notebook = notebookGroup; 

            // LÁPIZ MEJORADO
            const pencilGroup = new THREE.Group();
            const bodyGeometry = new THREE.CylinderGeometry(0.09, 0.09, 2.2, 32);
            const bodyMaterial = new THREE.MeshStandardMaterial({ 
                color: 0xfbbf24,
                roughness: 0.5,
                metalness: 0.2
            });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            pencilGroup.add(body);
            
            const tipGeometry = new THREE.ConeGeometry(0.09, 0.35, 32);
            const tipMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x78350f,
                roughness: 0.7,
                metalness: 0.1
            });
            const tip = new THREE.Mesh(tipGeometry, tipMaterial);
            tip.position.set(0, 1.275, 0);
            pencilGroup.add(tip);

            const leadGeometry = new THREE.ConeGeometry(0.035, 0.15, 32);
            const leadMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x171717,
                roughness: 0.9,
                metalness: 0.1
            });
            const lead = new THREE.Mesh(leadGeometry, leadMaterial);
            lead.position.set(0, 1.45, 0);
            pencilGroup.add(lead);

            const eraserGeometry = new THREE.CylinderGeometry(0.1, 0.1, 0.25, 32);
            const eraserMaterial = new THREE.MeshStandardMaterial({ 
                color: 0xfca5a5,
                roughness: 0.6,
                metalness: 0.1
            });
            const eraser = new THREE.Mesh(eraserGeometry, eraserMaterial);
            eraser.position.set(0, -1.225, 0);
            pencilGroup.add(eraser);

            const metalBandGeometry = new THREE.CylinderGeometry(0.095, 0.095, 0.12, 32);
            const metalBandMaterial = new THREE.MeshStandardMaterial({ 
                color: 0xd4d4d8,
                roughness: 0.2,
                metalness: 0.95
            });
            const metalBand = new THREE.Mesh(metalBandGeometry, metalBandMaterial);
            metalBand.position.set(0, -1.05, 0);
            pencilGroup.add(metalBand);

            pencilGroup.rotation.z = Math.PI / 5; 
            pencilGroup.position.set(0.6, 0.5, 0.15); 
            scene.add(pencilGroup);
            pencil = pencilGroup; 

            // Animación mejorada con GSAP
            gsap.to(notebook.position, {
                y: 0.15,
                duration: 2.5,
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut"
            });
            
            gsap.to(notebook.rotation, {
                y: Math.PI * 0.1,
                duration: 3,
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut"
            });

            gsap.to(pencil.position, {
                y: 0.7,
                duration: 2.8,
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut"
            });
            
            gsap.to(pencil.rotation, {
                z: Math.PI / 4,
                duration: 3.5,
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut"
            });
            
            // CREAR DOS CAPAS DE PARTÍCULAS
            particleSystem1 = createEnhancedParticles({
                count: 1200,
                size: 0.035,
                color1: '#2563eb',
                color2: '#60a5fa',
                opacity: 0.6
            });
            scene.add(particleSystem1);

            particleSystem2 = createEnhancedParticles({
                count: 800,
                size: 0.05,
                rangeX: 10,
                rangeY: 10,
                rangeZ: 10,
                color1: '#93c5fd',
                color2: '#dbeafe',
                opacity: 0.4
            });
            scene.add(particleSystem2);

            window.addEventListener('click', onCanvasClick);
            window.addEventListener('resize', onWindowResize);

            animate();
        }

        function onCanvasClick(event) {
            pointer.x = (event.clientX / window.innerWidth) * 2 - 1;
            pointer.y = - (event.clientY / window.innerHeight) * 2 + 1;

            raycaster.setFromCamera(pointer, camera);
            const intersects = raycaster.intersectObjects([notebook, pencil], true); 

            if (intersects.length > 0) {
                window.location.href = 'contacto.html';
            }
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animateParticles(particleSystem) {
            if (!particleSystem) return;

            const positions = particleSystem.geometry.attributes.position.array;
            const velocities = particleSystem.userData.velocities;
            const settings = particleSystem.userData.settings;

            for (let i = 0; i < positions.length; i += 3) {
                positions[i] += velocities[i];
                positions[i + 1] += velocities[i + 1];
                positions[i + 2] += velocities[i + 2];

                if (positions[i + 1] > settings.rangeY / 2) {
                    positions[i + 1] = -settings.rangeY / 2;
                }
                if (Math.abs(positions[i]) > settings.rangeX / 2) {
                    positions[i] = (Math.random() - 0.5) * settings.rangeX;
                }
                if (Math.abs(positions[i + 2]) > settings.rangeZ / 2) {
                    positions[i + 2] = (Math.random() - 0.5) * settings.rangeZ;
                }
            }

            particleSystem.geometry.attributes.position.needsUpdate = true;
            particleSystem.rotation.y += 0.0003;
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update(); 
            
            animateParticles(particleSystem1);
            animateParticles(particleSystem2);

            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>